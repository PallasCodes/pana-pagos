(function(t){function e(e){for(var n,s,i=e[0],l=e[1],c=e[2],u=0,d=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);m&&m(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,i=1;i<a.length;i++){var l=a[i];0!==o[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},o={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var m=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"01ec":function(t,e,a){"use strict";a("3de2")},"1b91":function(t,e,a){},"3de2":function(t,e,a){},4788:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("TheNavbar",{on:{"sign-out":t.logout}}),a("main",{staticClass:"py-4 container"},[a("router-view")],1)],1)},r=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[a("b-navbar-brand",{attrs:{to:"/"}},[t._v("Pagos Pana")]),a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{staticClass:"ml-auto"},[a("b-nav-item",{staticClass:"link",attrs:{to:"/",active:"Home"==t.$route.name}},[t._v("Pagos")]),a("b-nav-item",{staticClass:"link",attrs:{to:"/deleted",active:"Deleted"==t.$route.name}},[t._v("Pagos eliminados")]),a("b-nav-item",{staticClass:"link",on:{click:function(e){return t.$emit("sign-out")}}},[t._v("Cerrar sesión")])],1)],1)],1)],1)},i=[],l=(a("01ec"),a("2877")),c={},m=Object(l["a"])(c,s,i,!1,null,"7a313794",null),u=m.exports,d=a("bc3a"),p=a.n(d),f={components:{TheNavbar:u},beforeCreate:function(){localStorage.clear(),this.$router.push("/login")},methods:{logout:function(){localStorage.clear(),this.$router.push("/login")}}},b=f,v=Object(l["a"])(b,o,r,!1,null,null,null),h=v.exports,g=a("2f62"),y=(a("b0c0"),function(){}),_={isLoggedIn:function(t){return t.isLoggedIn}},$={setToken:function(t,e){t.token=e,t.isLoggedIn=!0},setRole:function(t,e){t.role=e},setName:function(t,e){t.name=e},autoLogin:function(t){var e=localStorage.getItem("token");e?(t.token=e,t.isLoggedIn=!0,p.a.defaults.headers.common["Authorization"]="Bearer "+e):(t.token="",t.isLoggedIn=!1,p.a.defaults.headers.common["Authorization"]="")}},k={},P={state:y,getters:_,actions:k,mutations:$};n["default"].use(g["a"]);var C=new g["a"].Store({state:{},getters:{},mutations:{},actions:{},modules:{auth:P}}),x=a("8c4f"),w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("PaymentsList",{attrs:{url:"/payments",mode:"normal"}})],1)},M=[],D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"payments-list"},[a("b-toast",{attrs:{id:"error",solid:"",variant:"danger","append-toast":""}},[a("b",[t._v(t._s(t.getErrorMessage))])]),a("b-toast",{attrs:{id:"success",solid:"",variant:"success","append-toast":""}},[a("b",[t._v(t._s(t.getSuccessMessage))])]),a("b-modal",{attrs:{id:"payDetailsModal","hide-footer":"",title:"Detalles de pago"}},[a("PaymentDetails",{attrs:{mode:t.mode,payment:t.selectedPayment},on:{"success-delete":t.paymentDeleted,"error-delete":t.paymentError,close:function(e){return t.$bvModal.hide("payDetailsModal")}}})],1),a("b-modal",{attrs:{id:"addPaymentModal","hide-footer":"",title:"Registrar nuevo pago"}},[a("AddPaymentForm",{key:"1",on:{"sucess-payment":t.sucessToast,"error-payment":t.errorToast}})],1),a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col-lg-6"},[t.isLoading||"normal"!==t.mode?t._e():a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.addPaymentModal",modifiers:{addPaymentModal:!0}}],staticClass:"mb-1",attrs:{variant:"primary"}},[t._v("Registrar pago")]),t.isLoading?a("b-spinner",{staticClass:"mx-auto d-block mt-4",staticStyle:{width:"4rem",height:"4rem"},attrs:{label:"Large Spinner"}}):t._e(),t._l(t.getPayments,(function(e){return a("Payment",{key:e._id,staticClass:"my-2",attrs:{payment:e},on:{open:t.openModal}})}))],2)])],1)},S=[],j=(a("4de4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card payment",on:{click:t.openPaymentDetails}},[a("div",{staticClass:"card-body"},[a("span",[a("b",[t._v("Estudiante:")]),t._v(" "+t._s(t.payment.student)+" - "+t._s(t.payment.semester))]),a("span",[a("b",[t._v("Cantidad:")]),t._v(" "+t._s(t.payment.amount))]),a("span",[a("b",[t._v("Fecha:")]),t._v(" "+t._s(t.formatDate(t.payment.createdAt)))]),a("span",[a("b",[t._v("Registrado por:")]),t._v(" "+t._s(t.capitalize(t.payment.user)))])])])}),E=[],L=(a("fb6a"),a("99af"),{name:"Payment",props:["payment"],methods:{openPaymentDetails:function(){this.$emit("open",this.payment)},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},formatDate:function(t){var e=new Date(t),a=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],n=e.getFullYear(),o=a[e.getMonth()],r=e.getDate(),s=e.getHours(),i=e.getMinutes();return"".concat(r,"/").concat(o,"/").concat(n," a las ").concat(s,":").concat(i)}}}),O=L,I=(a("d02d"),Object(l["a"])(O,j,E,!1,null,"2cfa8690",null)),T=I.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addPaymentForm"},[a("strong",{staticClass:"mb-3 d-block text-primary"},[t._v("Solo los campos marcados con * son obligatorios")]),t.show?a("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSubmit.apply(null,arguments)},reset:t.onReset}},[a("b-form-group",{attrs:{id:"group-student",label:"*Nombre completo del estudiante:","label-for":"student"}},[a("b-form-input",{attrs:{id:"student",type:"text",state:t.validateState("student"),"aria-describedby":"student-feedback"},model:{value:t.form.student,callback:function(e){t.$set(t.form,"student",e)},expression:"form.student"}}),a("b-form-invalid-feedback",{attrs:{id:"student-feedback"}},[t._v("Campo requerido.")])],1),a("b-form-group",{attrs:{id:"group-amount",label:"*Cantidad:","label-for":"amount"}},[a("b-form-input",{attrs:{id:"amount",type:"number",state:t.validateState("amount"),"aria-describedby":"amount-feedback"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}}),a("b-form-invalid-feedback",{attrs:{id:"amount-feedback"}},[t._v("Campo requerido.")])],1),a("b-form-group",{attrs:{id:"group-semester",label:"*Semestre:","label-for":"semester"}},[a("b-form-select",{attrs:{id:"semester",state:t.validateState("semester"),options:t.semesters,"aria-describedby":"semester-feedback"},model:{value:t.form.semester,callback:function(e){t.$set(t.form,"semester",e)},expression:"form.semester"}}),a("b-form-invalid-feedback",{attrs:{id:"semester-feedback"}},[t._v("Campo requerido.")])],1),a("b-form-group",{attrs:{id:"group-concept",label:"Concepto:","label-for":"concept"}},[a("b-form-input",{attrs:{id:"concept",type:"text"},model:{value:t.form.concept,callback:function(e){t.$set(t.form,"concept",e)},expression:"form.concept"}})],1),a("b-form-group",{attrs:{id:"group-month",label:"Mes que cubre:","label-for":"month"}},[a("b-form-input",{attrs:{id:"month",type:"text"},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}})],1),a("b-form-group",{attrs:{id:"group-limitDate",label:"Fecha límite:","label-for":"limitDate"}},[a("b-form-input",{attrs:{id:"limitDate",type:"date"},model:{value:t.form.limitDate,callback:function(e){t.$set(t.form,"limitDate",e)},expression:"form.limitDate"}})],1),a("b-form-group",{attrs:{id:"group-comment",label:"Comentario extra:","label-for":"comment"}},[a("b-form-textarea",{staticClass:"mb-4",attrs:{id:"comment",rows:"3"},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment",e)},expression:"form.comment"}})],1),a("b-button",{staticClass:"mr-2",attrs:{variant:"outline-primary"}},[t._v("Cancelar")]),a("b-button",{attrs:{type:"submit",variant:"primary"}},[t.isLoading?a("span",{staticClass:"d-flex justify-content-center align-items-center"},[a("b-spinner",{attrs:{small:""}}),a("span",{staticClass:"ml-1"},[t._v("Registrando")])],1):t._e(),t.isLoading?t._e():a("span",[t._v("Registrar")])])],1):t._e()],1)},R=[],A=a("1dce"),F=a.n(A),z=a("b5ae"),N={mixins:[A["validationMixin"]],validations:{form:{student:{required:z["required"]},amount:{required:z["required"]},semester:{required:z["required"]}}},data:function(){return{form:{student:"",amount:null,semester:null,concept:"",month:"",limitDate:"",comment:""},semesters:[{text:"Seleccionar",value:null},"1er","2do","3er","4to","5to","6to"],show:!0,loading:!1}},computed:{isLoading:function(){return this.loading}},methods:{validateState:function(t){var e=this.$v.form[t],a=e.$dirty,n=e.$error;return a?!n:null},onSubmit:function(){var t=this;this.$v.form.$touch(),this.$v.form.$anyError||(this.loading=!0,p.a.post("/payments",this.form).then((function(e){t.$emit("sucess-payment","Pago registrado con éxito.",e.data.payment),t.loading=!1})).catch((function(e){t.$emit("error-payment","Error al registrar pago. Inténtelo más tarde."),t.loading=!1})))},onReset:function(t){var e=this;t.preventDefault(),this.form.email="",this.form.name="",this.form.food=null,this.form.checked=[],this.show=!1,this.$nextTick((function(){e.show=!0}))}}},H=N,B=Object(l["a"])(H,q,R,!1,null,null,null),J=B.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"payment-details"},[a("span",[a("b",[t._v("Estudiante:")]),t._v(" "+t._s(t.payment.student)+" - "+t._s(t.payment.semester))]),a("span",[a("b",[t._v("Cantidad:")]),t._v(" "+t._s(t.payment.amount))]),a("span",[a("b",[t._v("Fecha:")]),t._v(" "+t._s(t.formatDate(t.payment.createdAt)))]),a("span",[a("b",[t._v("Registrado por:")]),t._v(" "+t._s(t.payment.user))]),a("span",[a("b",[t._v("Concepto:")]),t._v(" "+t._s(t.payment.concept))]),a("span",[a("b",[t._v("Fecha límite:")]),t._v(" "+t._s(t.formatDate(t.payment.limitDate)))]),a("span",[a("b",[t._v("Mes que cubre:")]),t._v(" "+t._s(t.payment.month))]),t._m(0),a("span",[t._v(t._s(t.payment.comment))]),a("div",{staticClass:"mt-3"},["normal"===t.mode?a("b-button",{staticClass:"mr-2",attrs:{variant:"danger",type:"button"},on:{click:t.deletePayment}},[t._v(" Eliminar ")]):t._e(),"deleted"===t.mode&&"admin"===t.role?a("b-button",{staticClass:"mr-2",attrs:{variant:"danger",type:"button"},on:{click:t.destroyPayment}},[t._v(" Eliminar ")]):t._e(),a("b-button",{attrs:{variant:"primary",type:"button"},on:{click:function(e){return t.$emit("close")}}},[t._v("Cerrar ventana")])],1)])},Y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("b",[t._v("Comentario extra:")])])}],G={name:"PaymentDetails",props:["payment","mode"],data:function(){return{role:""}},methods:{deletePayment:function(){var t=this;p.a.put("/payments/"+this.payment._id).then((function(e){t.$emit("success-delete","Pago eliminado con éxito.",t.payment._id)})).catch((function(e){t.$emit("error-delete","Error al eliminar pago. Inténtelo más tarde")}))},destroyPayment:function(){var t=this;p.a.delete("/payments/"+this.payment._id).then((function(e){t.$emit("success-delete","Pago eliminado con éxito.",t.payment._id)})).catch((function(e){t.$emit("error-delete","Error al eliminar pago. Inténtelo más tarde")}))},formatDate:function(t){if(!t)return"";var e=new Date(t),a=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],n=e.getFullYear(),o=a[e.getMonth()],r=e.getDate(),s=e.getHours(),i=e.getMinutes();return"".concat(r,"/").concat(o,"/").concat(n," a las ").concat(s,":").concat(i)}},mounted:function(){this.role=localStorage.getItem("role")}},K=G,Q=(a("8b87"),Object(l["a"])(K,U,Y,!1,null,"35b3cd16",null)),V=Q.exports,W={name:"PaymentsList",props:["mode","url"],components:{Payment:T,AddPaymentForm:J,PaymentDetails:V},data:function(){return{payments:[],loading:!0,selectedPayment:null,successMessage:"",errorMessage:""}},computed:{isLoading:function(){return this.loading},getSuccessMessage:function(){return this.successMessage},getErrorMessage:function(){return this.errorMessage},getPayments:function(){return this.payments}},methods:{openModal:function(t){this.$bvModal.show("payDetailsModal"),this.selectedPayment=t},sucessToast:function(t,e){this.successMessage=t,this.payments.unshift(e),this.$bvModal.hide("addPaymentModal"),this.$bvToast.show("success")},errorToast:function(t){this.errorMessage=t,this.$bvModal.hide("addPaymentModal"),this.$bvToast.show("error")},paymentDeleted:function(t,e){console.log(e),this.successMessage=t,this.payments=this.payments.filter((function(t){return t._id!==e})),this.$bvModal.hide("payDetailsModal"),this.$bvToast.show("success")},paymentError:function(t){this.errorMessage=t,this.$bvModal.hide("payDetailsModal"),this.$bvToast.show("error")}},mounted:function(){var t=this;p.a.get(this.url).then((function(e){t.payments=e.data,t.loading=!1})).catch((function(t){return console.error(t)}))}},X=W,Z=Object(l["a"])(X,D,S,!1,null,null,null),tt=Z.exports,et={name:"Home",components:{PaymentsList:tt}},at=et,nt=Object(l["a"])(at,w,M,!1,null,null,null),ot=nt.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"deleted"},[a("PaymentsList",{attrs:{url:"/payments/deleted",mode:"deleted"}})],1)},st=[],it={name:"Deleted",components:{PaymentsList:tt}},lt=it,ct=Object(l["a"])(lt,rt,st,!1,null,null,null),mt=ct.exports,ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-content-center",attrs:{id:"login"}},[a("div",{staticClass:"col-lg-4"},[a("h2",{staticClass:"mb-4 mt-2 text-center"},[t._v("Iniciar sesión")]),a("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.onSubmit.apply(null,arguments)},reset:t.onReset}},[a("b-form-group",{attrs:{id:"name-group",label:"Nombre de usuario:","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("b-form-group",{attrs:{id:"password-group",label:"Contraseña:","label-for":"password"}},[a("b-form-input",{attrs:{id:"password",type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("b-button",{staticClass:"w-100 mt-1",attrs:{type:"submit",variant:"primary"}},[t._v("Iniciar sesión")])],1)],1)])},dt=[],pt={data:function(){return{form:{name:"",password:""}}},methods:{onSubmit:function(){var t=this;p.a.post("/auth/login",this.form).then((function(e){p.a.defaults.headers.common["Authorization"]="Bearer "+e.data.token,localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role),localStorage.setItem("name",e.data.name),t.$router.push("/")})).catch((function(t){return console.error(t)}))},onReset:function(t){var e=this;t.preventDefault(),this.form.email="",this.form.name="",this.form.food=null,this.form.checked=[],this.show=!1,this.$nextTick((function(){e.show=!0}))}}},ft=pt,bt=Object(l["a"])(ft,ut,dt,!1,null,null,null),vt=bt.exports;n["default"].use(x["a"]);var ht=[{path:"/",name:"Home",component:ot,meta:{requiresAuth:!0}},{path:"/deleted",name:"Deleted",component:mt,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:vt}],gt=new x["a"]({mode:"history",base:"/",routes:ht});gt.beforeEach((function(t,e,a){var n=localStorage.getItem("token");t.matched.some((function(t){return t.meta.requiresAuth&&!n}))?a({path:"/login"}):a()}));var yt=gt,_t=a("5f5b"),$t=a("b1e0");a("f9e3"),a("2dd8");p.a.defaults.baseURL="https://pana-pagos.herokuapp.com",n["default"].use(F.a),n["default"].config.productionTip=!1,n["default"].use(_t["a"]),n["default"].use($t["a"]),new n["default"]({router:yt,store:C,axios:p.a,render:function(t){return t(h)}}).$mount("#app")},"8b87":function(t,e,a){"use strict";a("1b91")},d02d:function(t,e,a){"use strict";a("4788")}});
//# sourceMappingURL=app.bd93e657.js.map